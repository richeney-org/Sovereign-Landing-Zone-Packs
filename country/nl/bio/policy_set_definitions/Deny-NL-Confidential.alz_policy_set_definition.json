{
  "name": "Deny-NL-Confidential",
  "type": "Microsoft.Authorization/policySetDefinitions",
  "apiVersion": "2021-06-01",
  "properties": {
    "displayName": "Deny - Additional Non-BIO Sovereignty Controls for the Netherlands - Confidential Workloads",
    "description": "This policy set enforces optional security controls for Dutch confidential workloads.",
    "policyType": "Custom",
    "metadata": {
      "category": "Regulatory Compliance",
      "alzCloudEnvironments": [
        "AzureCloud"
      ],
      "source": "https://github.com/richeney-org/Sovereign-Landing-Zone-Packs/",
      "version": "1.0.0"
    },
    "parameters": {
      "AllowedVirtualMachineSKUs": {
        "type": "Array",
        "metadata": {
          "displayName": "Allowed virtual machine SKUs",
          "description": "The list of virtual machine SKUs that can be deployed"
        },
        "defaultValue": []
      },
      "effectForKeyVaultPremiumSKU": {
        "type": "String",
        "metadata": {
          "displayName": "Effect for Key Vault Premium SKU policy",
          "description": "The effect determines what happens when the policy rule is evaluated to match"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Deny"
      }
    },
    "policyDefinitions": [
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3",
        "policyDefinitionReferenceId": "AllowedVirtualMachineSKUs",
        "parameters": {
          "listOfAllowedSKUs": {
            "value": "[parameters('AllowedVirtualMachineSKUs')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/placeholder/providers/Microsoft.Authorization/policyDefinitions/Enforce-KV-Premium",
        "policyDefinitionReferenceId": "KeyVaultShouldUsePremiumSKU",
        "parameters": {
          "effect": {
            "value": "[parameters('effectForKeyVaultPremiumSKU')]"
          }
        }
      }
    ]
  }
}